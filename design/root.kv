<MyButton@Button>

<SubmitButton@Button>:
    size_hint: None, None
    pos_hint: {'y':0.9}
    size: 150, 40

<FormLayout@StackLayout>:
    padding: 10
    orientation: 'lr-tb'
    non_field_errors: non_field_errors
    title: 'default'

    FormTitle:
        text: root.title

    ErrorLabel:
        id: non_field_errors
        halign: 'center'

    SuccessLabel:
        id: success_label

<FormTitle@Label>:
    font_size: 32
    padding_y: 20
    size_hint: 1, None

<FormInput@TextInput>:
    size_hint: 1, None
    size: 1, 40

<ErrorLabel@Label>:
    size_hint: 1, None
    size: self.texture_size
    text_size: self.size
    padding_y: 10
    halign: 'left'
    valign: 'middle'
    color: 1,0,0,1

<SuccessLabel@ErrorLabel>:
    halign: 'center'
    color: 0,1,0,1


<RootWidget@BoxLayout>:
    orientation: 'vertical'
    screen_manager: screen_manager

    NotLoggedMenu:
        screen_manager: screen_manager

    NotLoggedNavigator:
        id: screen_manager


<NotLoggedMenu@BoxLayout>:
    orientation: 'horizontal'
    size_hint: 1, 0.1
    screen_manager: None

    MyButton:
        text: "Main page"
        on_press:
            root.screen_manager.current = 'main_page'

    MyButton:
        text: "Menu"
        on_press:
            root.screen_manager.current = 'menu'


<NotLoggedNavigator@ScreenManager>:
    size_hint: 1, 0.9

    Screen:
        name: 'menu'
        BoxLayout:
            orientation: 'vertical'
            MyButton:
                text: "Login"
                on_press:
                    root.current = 'login'
            MyButton:
                text: "Create account"
                on_press:
                    root.current = 'register'
            MyButton:
                text: "About"

    Screen:
        name: 'main_page'

    Screen:
        name: 'login'
        LoginForm:
            id: login_form

    Screen:
        name: 'register'
        RegisterForm:
            id: register_form


<LoginForm@FormLayout>:
    title: 'Login'
    screen_manager: None
    username: username
    password: password
    username_error: username_error
    password_error: password_error

    FormInput:
        id: username
        hint_text: 'Username'
    ErrorLabel:
        id: username_error

    FormInput:
        id: password
        hint_text: 'Password'
        password: True
    ErrorLabel:
        id: password_error

    FloatLayout:
        SubmitButton:
            text: 'Login'
            center_x: root.center_x
            on_press: root.login()



<RegisterForm@FormLayout>:
    title: 'Create account'

    username: username
    email: email
    password: password

    username_error: username_error
    email_error: email_error
    password_error: password_error

    FormInput:
        hint_text: 'Email'
        id: email
    ErrorLabel:
        id: email_error

    FormInput:
        hint_text: 'Username'
        id: username
    ErrorLabel:
        id: username_error

    FormInput:
        hint_text: 'Password'
        password: True
        id: password
    ErrorLabel:
        id: password_error

    FloatLayout:
        SubmitButton:
            text: 'Submit'
            center_x: root.center_x
            on_press: root.register()


